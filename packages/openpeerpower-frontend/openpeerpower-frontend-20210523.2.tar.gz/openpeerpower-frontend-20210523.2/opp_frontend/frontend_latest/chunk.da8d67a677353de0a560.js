(self.webpackChunkopenpeerpower_frontend=self.webpackChunkopenpeerpower_frontend||[]).push([[6532],{66532:(e,t,s)=>{"use strict";s.r(t),s.d(t,{CastManager:()=>d,getCastManager:()=>u});var n=s(69470);let a;var i=s(54049),r=s(66628),o=s(91794);function c(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let h;class d{constructor(e){c(this,"auth",void 0),c(this,"status",void 0),c(this,"_eventListeners",{}),this.auth=e;const t=this.castContext;t.setOptions({receiverApplicationId:i.$Q,autoJoinPolicy:chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED}),t.addEventListener(cast.framework.CastContextEventType.SESSION_STATE_CHANGED,(e=>this._sessionStateChanged(e))),t.addEventListener(cast.framework.CastContextEventType.CAST_STATE_CHANGED,(e=>this._castStateChanged(e)))}addEventListener(e,t){return e in this._eventListeners||(this._eventListeners[e]=[]),this._eventListeners[e].push(t),()=>{this._eventListeners[e].splice(this._eventListeners[e].indexOf(t))}}get castConnectedToOurOpp(){return void 0!==this.status&&void 0!==this.auth&&this.status.connected&&(this.status.oppUrl===this.auth.data.oppUrl||i.Hq&&this.status.oppUrl===r.T)}sendMessage(e){this.castSession.sendMessage(i.py,e)}get castState(){return this.castContext.getCastState()}get castContext(){return cast.framework.CastContext.getInstance()}get castSession(){return this.castContext.getCurrentSession()}requestSession(){return this.castContext.requestSession()}_fireEvent(e){for(const t of this._eventListeners[e]||[])t()}_receiveMessage(e){"receiver_status"===e.type&&(this.status=e,this._fireEvent("connection-changed"))}_sessionStateChanged(e){"SESSION_STARTED"===e.sessionState||"SESSION_RESUMED"===e.sessionState?(this.auth?(0,o.Ni)(this,this.auth):this.sendMessage({type:"get_status"}),this._attachMessageListener()):"SESSION_ENDED"===e.sessionState&&(this.status=void 0,this._fireEvent("connection-changed"))}_castStateChanged(e){this._fireEvent("state-changed")}_attachMessageListener(){this.castSession.addMessageListener(i.py,((e,t)=>this._receiveMessage(JSON.parse(t))))}}const u=e=>(h||(h=(()=>{if(a)return a;a=new Promise((e=>{window.__onGCastApiAvailable=e}));const e=document.createElement("div");return e.id="cast",document.body.append(e),(0,n.fs)("https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"),a})().then((t=>{if(!t)throw new Error("No Cast API available");return new d(e)}))),h)},69470:(e,t,s)=>{"use strict";s.d(t,{j:()=>a,fs:()=>i,$y:()=>r});const n=(e,t,s)=>new Promise(((n,a)=>{const i=document.createElement(e);let r="src",o="body";switch(i.onload=()=>n(t),i.onerror=()=>a(t),e){case"script":i.async=!0,s&&(i.type=s);break;case"link":i.type="text/css",i.rel="stylesheet",r="href",o="head"}i[r]=t,document[o].appendChild(i)})),a=e=>n("link",e),i=e=>n("script",e),r=e=>n("script",e,"module")}}]);
//# sourceMappingURL=chunk.da8d67a677353de0a560.js.map