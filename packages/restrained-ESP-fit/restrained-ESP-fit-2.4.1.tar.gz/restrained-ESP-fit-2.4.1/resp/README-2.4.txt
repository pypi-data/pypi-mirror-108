
               November 2013

    Standalone version of the RESP program
               Version 2.4

  Generated by the q4md-forcefieldtools team
      http://q4md-forcefieldtools.org/
          
    The RESP program is freely distributed
                See for instance 
 http://www.ccl.net/cca/software/SOURCES/FORTRAN/resp/

          Authorship: see resp.f

               --------

- How to compile this standalone version?
tar zxvf standalone-resp-2.x.tgz
cd resp-2.x
edit the "Makefile" & set "FC = Your-fortran-compiler" (i.e. gfortran, g77, ifort, pgf77...)
make clean
make

- How to install this standalone version?
Just become superuser (or root) and/or copy the "resp" binary where it can be found/used
cp resp /usr/local/bin/ (for instance)
   or
cp resp $HOME/bin/
   or
cp resp $AMBERHOME/exe/ (overwrite the resp binary from the AMBER distribution)

- Any question about this standalone RESP version?
See the q4md-fft mailing @ http://lists.q4md-forcefieldtools.org/ or 
    the Amber mailing list.

               --------

  This resp version is now that used by R.E.D. Server.

               --------

      The q4md-forcefieldtools team             
     contact@q4md-forcefieldtools.org

Modifications and evolution of the RESP program introduced in the vesion 2.4 


I. Modifications made to the code


- In the input and output files references to 'olecule' in the form of 'mol',
  'nmol' and '#mol' were removed and replaced by references to Molecular
  Electrostatic Potentials ('MEP', 'nmep', '#MEP'...) to avoid confusion when
  a multi-molecule, multi-conformation, multi-orientation fit is performed.
  Henceforth, MEP will refer to any collection of atoms for which a Molecular
  Electrostatic Potential will have been computed.
- Introduction of a 'return' in the routine 'readin' forces RESP 2.4 to follow
  the same route to perform charge fit for single-MEP and multi-MEP.
  This permits the use of the same format of inputs and outputs for the both
  types of fits. In particular, a blank line should always appear before the
  intra-molecular-charge-constraints section.
- In the input file containing the MEP coordinates ('espot' file), changing the
  format of the total number of MEP points from i5 to i6 allows for handling MEP
  grids of up to 999,999 points.
- The parameters 'maxmol', 'maxq', and 'maxlgr' were placed in a single
  'include' file. 'maxq' and 'maxlgr' are defined according to 'maxmol' to ease
  their modification.


II. Introduction of new type of restraints


The use of 'irstrnt = 3' will apply a restraining function developped by
Henchman and Essex[1], which is quadratic in charge, to generate OPLS-like
charges from MEP.


III. Electrostatic moments and associated quantities


III. 1. Coordinates of center of mass

In RESP 2.4, the coordinates of the center of mass are computed for each MEP of
a fit and are printed out in the 'Center of Mass' section of the output file.
The atomic masses used to compute these centers of mass are the ones we
introduced previously.

III. 2. Dipole moments

In RESP 2.4, dipole moments are computed for each molecule of a multi-MEP fit
too, while, in former versions, they were computed only for single-MEP fits.
The values of these moments are given in the 'Dipole moments' section of the
output file and they are printed out in the punch file too. For each molecule
the value of the dipole moment and its coordinates along the three axes are
computed at the origin of coordinates and at the center of mass of the molecule.

III. 3. Quadrupole moments

In RESP 2.4, quadrupoles moments are computed for each MEP of a multi-MEP fit
too, while, in former versions, they were computed only for single-MEP fits.
Moreover, the values outside the main diagonal have been corrected.
The traceless quadrupole moment matrices are computed with respect to the origin
of coordinates and with respect to center of mass of the molecule.
The diagonal quadrupole matrix is also computed for each molecule.
All these results are printed out in the 'Traceless Quadrupole moments' section
of the output file.


IV. esout file and related new files


IV. 1. esout file

The information given by the esout file undergone important changes.
In RESP 2.4, this file contains data corresponding to each MEP of a multi-MEP
fit in a sequential order:
- Three first columns: coordinates (x, y, and z) of the considered MEP point in
  atomic units.
- fourth column: value of the MEP at this point computed with Quantum Mechanics
  (QM) method: V_QM in atomic units.
- fifth column: value of the MEP at this point generated by the fitted charges:
  V_MM in atomic units.
- sixth column: differences between the QM MEP and the MEP generated by the
  fitted charges at this point (residual): V_resid = V_{QM} - V_{MM} in atomic
  units.

IV. 2. New 'pdb' files

RESP 2.4 writes three files with a pdb like format with the following names:
espdb, esqpotpdb, and esmpotpdb. In this files each MODEL section corresponds
to a different MEP, hence there are as many MODEL section as there are MEP in a
multi-MEP fit. In these files the residue called MOL correspond to the molecule
and the residues called POT correspond to each point where the MEP is computed.
For the atom positions, the TempFactor column contains the fitted charge for
each atom. For the MEP point positions, the use of the TempFactor column is
different for each file:
- esqpotpdb: value of the QM MEP: V_QM in atomic units,
- esmpotpdb: value of the MEP generated by the fitted charges V_MM in atomic
units,
- espdb: relative residual value: (V_QM - V_MM)/V_QM.


V. Statistics of the fitting


V. 1. Correction in the calculation procedure of the standard error of estimate

In former versions, in the case of a multi-MEP fit, the value of the standard
error of estimate was computed by dividing the residual sum of squares arising
from all the molecular electrostatic potentials (MEP) by the number of MEP
points describing the very last MEP. In RESP 2.4, the residual sum of squares
is divided by the total number of MEP points of the fit. That is to say, the
number of points arising from the sum of the number of MEP points for each MEP
of the fit.

V. 2. Pearson correlation coefficient

The squared value of the Pearson correlation coefficient of the fit, also
called r^2, is now calculated and printed out in the 'Statistics of the fitting'
section of the punch file.


VI. Bibliography


[1] Generation of OPLS-like Charges from Molecular Electrostatic Potential
Using Restraints, R. H. Henchman and J. W. Essex, Journal of Computational
Chemistry, Vol. 20, No. 5, 483-498 (1999)

